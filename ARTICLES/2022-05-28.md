# 2022-05-28

こんにちは

課題はどれくらい進みましたか？

なぜかgame2の実行に失敗します(バイナリをいじる前からです)
それ以外は完了しました

GetKeyboardDllNameの解析は？

だいぶ終わってたはずです
確認してきます

それなら、次は、NtUserLoadKeyboardLayoutExの解析だ。
win32k!NtUserLoadKeyboardLayoutEx

ReactOSのこの関数の第三引数の型が間違っているようだ。
win32ss/user/ntuser/kbdlayout.c 649行目。
おそらく構造体へのポインタだろうと。

## 実習 Payloadz

さて、今日はこれ：
https://github.com/katahiromz/PayLoadz
普通にRosBEでビルドしてくれ。

PayLordz32.exeとtarget32.exeというファイルができる。

上のリストからペイロードを指定して、特定のPIDに注入、逆注入できる。
また、リストからペイロードを指定して注入されたプロセスを起動できる。

target32.exeを起動して。

何やらPIDと時間を表示するプログラムだ。

このPIDをPayLordzに指定してPauseペイロードを注入すると。。。
時間が止まる！
意味わかる？

はい
今試してみました

逆注入すれば元に戻る。
時間を取得する関数をAPIフックしているわけだ。

メッセージボックスもフックできる。
MsgBoxTest

この仕組みを理解してくれ。ただし、APIフックは「疑わしい挙動」なので、決してシステムファイルなどにアクセスしないように。ウイルス扱いされてしまうぞ。

今日はここまで。

ありがとうございました

質問があれば受け付けます。

特にありません

---

[戻る](2022-05-22.md) | [次へ](2022-05-29.md)
